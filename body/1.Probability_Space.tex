\chapter{概率基础}\label{chap:probability_space}

\begin{introduction}[考试重点]
    \item 概率空间的定义
    \item 古典概型与几何概型
    \item 条件概率与独立
    \item 伯努利试验
\end{introduction}

\section{概率空间}

\subsection{随机事件}

\begin{definition}[样本空间]
    随机试验可能出现的\underline{基本}结果称为\textbf{样本点}(sample point)，记为$\omega$。样本的全体构成\textbf{样本空间}(sample space)，记为$\Omega=\{ \omega \}$。若样本点有至多可数个，则称为\textbf{离散样本空间}，若不可数，则称为\textbf{连续样本空间}。
\end{definition}

\begin{definition}[事件的古典定义]
    样本点$\omega$的集合称为（随机）\textbf{事件}(event)。
\end{definition}

随机现象被抽象为集合。事件间的包含、相等、互不相容关系，对应成集合间的包含、相等、不相交；逻辑运算（且、或、非等）对应成集合论运算（交、并、补等）。

\begin{example}
    设 $A$、$B$、$C$ 是某个随机现象的三个事件, 则
    \begin{itemize}
        \item 事件“$A$ 与 $B$ 发生, $C$ 不发生”可表示为: $AB\overline{C}$.
        \item 事件“$A$、$B$、$C$ 中至少有一个发生”可表示为: $A \cup B \cup C$.
        \item 事件“$A$、$B$、$C$ 中至少有两个发生”可表示为: $AB \cup AC \cup BC$.
        \item 事件“$A$、$B$、$C$ 中恰好有两个发生”可表示为: $AB\overline{C} \cup A\overline{B}C \cup \overline{A}BC$.
        \item 事件“$A$、$B$、$C$ 同时发生”可表示为: $ABC$.
        \item 事件“$A$、$B$、$C$ 都不发生”可表示为: $\overline{A} \cap \overline{B} \cap \overline{C}$.
        \item 事件“$A$、$B$、$C$ 不全发生”可表示为: $\overline{A} \cup \overline{B} \cup \overline{C}$.
    \end{itemize}
\end{example}

\begin{property}
    集合的运算性质：
    \begin{itemize}
        \item 交换律
              \begin{equation}\label{eq:commutativity_set}
                  A \cup B = B \cup A, \quad AB = BA
              \end{equation}
        \item 结合律
              \begin{equation}
                  (A \cup B) \cup C = A \cup (B \cup C), \quad (AB)C = A(BC)\label{eq:associative_law_set}
              \end{equation}
        \item 分配律
              \begin{gather}
                  (A \cup B) \cup C = A \cup (B \cup C),\label{eq:distributive_law_set1}\\
                  (A \cap B) \cup C = (A \cup C) \cap (B \cup C).\label{eq:distributive_law_set2}
              \end{gather}
        \item 对偶律 （De Morgan公式）
              \begin{gather}
                  \overline{A \cup B} = \overline{A} \cap \overline{B},\label{eq:DeMorgan_law_set1}\\
                  \overline{A \cap B} = \overline{A} \cup \overline{B}.\label{eq:DeMorgan_law_set2}
              \end{gather}
    \end{itemize}
\end{property}


\begin{remark}
    并与补是集合中最基本的运算：
    \begin{itemize}
        \item 交的运算可通过并与对立来实现 （对偶律）.
        \item 差的运算可通过对立与交来实现 （$A - B = A\overline{B}$）.
    \end{itemize}
\end{remark}

\subsection{概率空间}

为方便概率的定义，避免不可测集的出现，并不把$\Omega$的一切子集作为事件。

\begin{definition}[事件域]
    事件构成的全体称为\textbf{事件域}$\mathscr{F}$，是$\Omega$的子集族(collection of subsets)，应满足\underline{$\sigma$代数}的要求：
    \begin{itemize}
        \item $\emptyset \in \mathscr{F}$，代表无事发生;
        \item $A\in\mathscr{F} \implies A^{\complement}\in\mathscr{F}$，即$\mathscr{F}$对补集运算(逻辑上的非)封闭;
        \item $A_{1},\dots,A_{n},\ldots \in \mathscr{F} \implies \bigcup_{n=1}^{\infty}A_{n} \in \mathscr{F}$，即$\mathscr{F}$对可数并运算封闭。
    \end{itemize}
\end{definition}

\begin{remark}
    可数性是为了在数学上能够恰当地处理\underline{无穷}的概念, 术语中的$\sigma$指的就是\underline{可数并}。由对偶原理可得$\sigma$域同时对可数并运算封闭. 即$\sigma$域对逆, 并, 交, 差的可数次运算封闭.
\end{remark}

事件域根据问题的不同要求适当选取。在概率定义没有困难时，应尽量取得大，通常以$\Omega$的一切子集作为事件域。当$\Omega$给定后，若某些子集必须作为事件处理，能否找到包含他们的$\sigma$域？

\begin{proposition}
    若给定$\Omega$的一个非空集族$\mathscr{G}$, 必存在$\Omega$上唯一的$\sigma$域$\mathfrak{m}(\mathscr{G})$, 满足下列性质:
    \begin{itemize}
        \item 包含$\mathscr{G}$
        \item 若其他$\sigma$域包含$\mathscr{G}$, 则必包含$\mathfrak{m}(\mathscr{G})$
    \end{itemize}
    这个$\mathfrak{m}(\mathscr{G})$称为包含$\mathscr{G}$的最小$\sigma$域, 或由$\mathscr{G}$扩张而成的$\sigma$域.
\end{proposition}

\emph{扩张}, 或者称为\emph{延拓}, 是数学中很重要的一个概念, 大抵是将某映射的定义域适当扩大, 不改变在初始定义域上的映射取值(注意值域可能是比较抽象的集合, 配备了某些操作之后被称为空间), 同时在扩大后的定义域上仍然保持某些优良的性质. 与此相对的概念是\emph{限制}, 即关心局部上可能更加漂亮的性质, 把初始的定义域适当缩小.

\begin{proof}
    由于$\Sigma$的一切子集构成的集类包含$\mathscr{G}$, 所以$\mathfrak{m}$存在. 再取$\Sigma$上满足此条件的$\sigma$域之交作为$\mathfrak{m}(\mathscr{G})$即可.
\end{proof}

特别地, 实数集$\R$的子集族$\{(-\infty,x] : x\in\R\}$生成的$\sigma$代数$\mathscr{B}_{\R}$称为$\R$上的\emph{Borel代数}.

\begin{definition}[Borel集]
    设$\mathbb{R}^1$为全集, 形为$[a,b)$构成的集类产生的$\sigma$域称为\textbf{一维Borel$\sigma$域}, 记为$\mathscr{B}_1$, 其中的元素称为\textbf{一维Borel集}
\end{definition}

若$x,y$为任意实数,由于:
\begin{align*}
    \{x\}  & =  \bigcap_{n=1}^{\infty}\left[x, x+\frac1{n}\right) \\
    (x, y) & =  [x, y)-\{x\}                                      \\
    [x, y] & =  [x, y)+\{y\}                                      \\
    (x, y] & =  [x, y)+\{y\}-\{x\}
\end{align*}
因此$\mathscr{B}_1$包含一切开区间, 闭区间, 单个实数, 可列个实数, 以及他们经可列次逆, 并, 交, 差运算的集合.

\begin{definition}[概率空间]
    设$\Omega$为一个样本空间，$\mathscr{F}$为定义于其上的一个事件域。定义在\underline{事件域}(非样本空间)上的集合函数$P : \mathscr{F} \to \mathbb{R}$称为\textbf{概率}的条件是:
    \begin{description}
        \item[非负性] $\P(A)\ge 0 , \forall A \in \mathscr{F}$
        \item[规范性] $\P(\Omega) = 1$; (如果没有这条就是一般的\underline{有限测度})
        \item[可列可加性] 若$A_{1},\dots,A_{n},\ldots \in \mathscr{F}$两两不交, 即$A_{i}\cap A_{j} = \emptyset, \ \forall i\neq j$, 则
            \[ \P(\bigcup_{n=1}^{\infty}A_{n}) = \sum_{n=1}^{\infty}\P(A_{n}) \]
    \end{description}
    并称$(\Omega,\mathscr{F},\P)$为一个\textbf{概率空间}(probability space)
\end{definition}

\subsection{概率的性质}

\begin{property}
    概率的性质:
    \begin{itemize}
        \item $P(\emptyset)=0$;
        \item $P(A^{\complement})=1-P(A)$;
        \item 若$A \subseteq B $ 则 $P(A)\le P(B)$;
    \end{itemize}
\end{property}

\begin{example}
    口袋中有编号为$1, 2, \cdots, n$的$n$个球，从中有放回地任取$m$次，求取出的$m$个球的最大号码为$k$的概率。
\end{example}
\begin{solution}
    记事件$A_k$为“取出的$m$个球的最大号码为$k$”。如果直接考虑事件$A_k$，则比较复杂，因为“最大号码为$k$”可以包括取到1次 $k$、取到2次$k$、\dots、取到$m$次$k$。为此我们记事件$B_i$为“取出的$m$个球的最大号码小于等于$i$”。则$B_i$发生只需每次从$1,2,\cdots ,i$号球中取球即可。由题可知
    \[  P(B_i) = \frac{i^m}{n^m}, \quad i = 1, 2, \dotsc, n. \]
    又因为$A_k = B_k - B_{k-1}$，且 $B_{k-1} \subset B_k$，所以
    \begin{align*}
        P(A_k) & = P(B_k - B_{k-1}) = P(B_k) - P(B_{k-1})                 \\
               & = \frac{k^m - (k - 1)^m}{n^m}, \quad k = 1,2, \dotsc, n.
    \end{align*}
\end{solution}

\begin{proposition}[加法公式]\label{pro:addition_law}
    基础形式:
    \[ P(A \cup B) = P(A) + P(B) - P(AB) \]
    一般形式:
    \begin{align*}
        P\biggl(\bigcup_{i=1}^n A_i \biggr)= & \sum_{i=1}^n P (A_i) - \sum_{1\le i < j < \le n}P(A_i A_j)+                             \\
                                             & \sum_{1 \le i < j < k \le n} P(A_i A_j A_k)+ \dotsb + (-1)^{n-1} P(A_1 A_2 \dotsb A_n). \\
    \end{align*}
    特别地，若事件出现个数相同时概率相等，则可简化为:
    \[ P\biggl( \bigcup_{i=1}^n A_i \biggr)=n P_{1} - \binom{n}{2} P_{2} + \binom{n}{3} P_{3}- \cdots+(-1)^{n-1} P_{n} \]
\end{proposition}

\begin{corollary}
    对任意$n$个事件$A_1,\cdots ,A_n$有
    \[ P \biggl( \bigcup_{i=1}^n A_i \biggr) \le \sum _{i=1} ^n P (A_i). \]
\end{corollary}

\begin{example}[配对问题]\label{exam:pairing}
    在一个有$n$个人参加的晚会上，每个人带了一件礼物，且假定各人带的礼物都不相同。晚会期间各人从放在一起的$n$件礼物中随机抽取一件，问至少有一个人自己抽到自己礼物的概率是多少？
\end{example}

\begin{solution}
    以$A_i$记事件“第$i$个人自己抽到自己的礼物”，则所求概率为$P(A_1 \cup A_2 \cup \dotsb \cup A_n)$。因为
    \begin{align*}
         & P(A_1) = P(A_2) = \dotsb = P(A_n) =\frac1{n}                                              \\
         & P(A_1 A_2) = P(A_1 A_3) = \dotsb = P(A_{n-1} A_n) = \frac1{n (n-1)}                       \\
         & P(A_1 A_2 A_3) = P(A_1 A_2 A_4) = \dotsb = P(A_{n-2} A_{n-1} A_n) = \frac1{n (n-1) (n-2)} \\
         & \ldots                                                                                    \\
         & P(A_1 A_2 \dotsb A_n) = \frac1{n!}
    \end{align*}
    再由概率的加法公式\ref{pro:addition_law}得
    \[ P(A_1 \cup A_2 \cup \dotsb \cup A_n) = 1 - \frac1{2!} + \frac1{3!} - \frac1{4!} + \dotsb + (-1)^{n-1} \frac1{n!} \]
\end{solution}

显然，可列可加性可以推出有限可加性。但是一般而言，由有限可加性不能推出可列可加性。设$A_i \in \mathscr{F}, i=1,2,\cdots $且两两互不相容，则由概率的有限可加性只能推出下式成立：
\[ P\biggl( \bigcup _{i=1} ^n A_i \biggr)=\sum_{i=1}^n P(A_i) \]
这个等式的左边对任意$n$都不超过$1$，因此右边的正项级数收敛。这样应有
\[ \lim_{n \to \infty}P\biggl(\bigcup_{i=1}^n A_i \biggr) =\lim_{n \to \infty}\sum_{i=1}^n P(A_i)=\sum_{i=1}^{\infty} P(A_i) \]
即若希望由有限可加性推出可列可加性，则需要下式成立:
\[ P(\sum_{i=1}^{\infty} A_i)=\sum_{i=1}^{\infty} P(A_i)=\lim_{n \to \infty}P(\sum_{i=1}^n A_i) \]
可写为：
\[ P(\lim_{n \to \infty}\sum_{i=1}^{n} A_i)=\lim_{n \to \infty}P(\sum_{i=1}^n A_i) \]

若记
\[ S_n=\sum_{i=1}^n A_i \]
则$S_n \in \mathscr{F}$而且$S_n \subseteq S_{n+1}$, 即$\{ S_n \}$是$\mathscr{F}$中一个单调不减的集序列，这时将上式改写改写为：
\[ P(\lim_{n \to \infty}S_n)=\lim_{n \to \infty}P(S_n) \]

\begin{definition}[下连续]
    对于$\mathscr{F}$上的集合函数$P$，若它对$\mathscr{F}$中\underline{任一单调不减}的集序列$\{ S_n \}$均满足:
    \[ \lim_{n \to \infty}P(S_n) =P(\lim_{n \to \infty} S_n) \]
    则称它是\textbf{下连续}的.
\end{definition}

\begin{theorem}
    若$P$是$\mathscr{F}$上满足$P(\Omega)=1$的非负集合函数，则它具有可列可加性的充要条件为:
    \begin{itemize}
        \item 它是有限可加的；
        \item 它是下连续的．
    \end{itemize}
\end{theorem}
\begin{proof}
    由上述推导可知其充分性。对于其必要性，有限可加也是易知的。设$\{S_n\}$是 $\mathscr{F}$中一个单调不减的事件序列，即
    \[ \bigcup _{i=1} ^{+\infty} S_i = \lim_{n \to +\infty} S_n \]
    若定义$S_0 = \emptyset$，则
    \[ \bigcup_{i=1}^{+\infty} S_i = \bigcup_{i=1}^{+\infty} (S_i - S_{i-1}) \]
    由于$S_{i-1} \subset S_i$，显然诸$(S_i-S_{i-1})$两两不相容，再由可列可加性得
    \[ P\biggl( \bigcup_{i=1}^{+\infty} S_i \biggr) = \sum_{i=1}^{+\infty} P(S_i - S_{i-1}) = \lim_{n \to +\infty} \sum_{i=1}^n P (S_i - S_{i-1}) \]
    由有限可加性得
    \[ \sum_{i=1}^n P(S_i - S_{i-1}) = P \biggl( \bigcup_{i=1}^n (S_i - S_{i-1}) \biggr) = P(S_n) \]
    所以
    \[ P(\lim_{n \to +\infty} S_n) = \lim_{n \to +\infty} P(S_n) \]
    这就证得了$P$的下连续性.
\end{proof}

同理定义上连续
\begin{definition}[上连续]
    对于$\mathscr{F}$上的集合函数$P$，若它对$\mathscr{F}$中\underline{任一单调不增}的集序列$\{ B_n \}$均满足:
    \[ \lim_{n \to \infty}P(B_n) =P(\lim_{n \to \infty} B_n) \]
    则称它是\textbf{上连续}的.
\end{definition}

\begin{theorem}
    概率是上连续的
\end{theorem}
\begin{proof}
    设$\{ B_n \}$是单调不增的事件序列，则$\{ \overline{B_n} \}$为单调不减的事件序列，由概率的下连续性得
    \begin{align*}
        1 - \lim_{n \to +\infty} P(B_n)
         & = \lim_{n \to +\infty} [1 - P(B_n)] = \lim_{n \to +\infty} P (\overline{B_n})                                         \\
         & = P \biggl( \bigcup_{n=1}^{+\infty} \overline{B_n} \biggr) = P \biggl( \overline{\bigcap _{n=1} ^{+\infty} B_n} \biggr) \\
         & = 1 - P \biggl( \bigcap_{n=1}^{+\infty} B_n \biggr).
    \end{align*}
    由于$\{ B_n \}$单调不增，所以
    \[ \lim_{n \to +\infty} P(B_n) = P \biggl( \bigcap_{n=1}^{+\infty} B_n \biggr) = P \biggl(\lim_{n \to +\infty} B_n \biggr) \]
\end{proof}

\section{古典概型与几何概型}

\subsection{古典概型}

古典概型的基本思想:
\begin{description}
    \item[有限个样本点] 所涉及的随机现象只有有限个样本点, 譬如为 $n$ 个, 且这些事件是两两互不相容的；
    \item[等可能性] 每个样本点发生的可能性相等
\end{description}

\begin{definition}[古典概型]
    若事件 $A$ 含有 $k$ 个样本点, 则事件 $A$ 的概率为
    \[  P (A) = \frac{\text{事件 } A \text{ 所含样本点的个数}}{\Omega \text{ 中所有样本点的个数}} = \frac{k}{n} \]
\end{definition}

\begin{note}
    古典概型的大部分问题都能形象化地用摸球模型来描述。以后我们经常研究摸球模型，意义即在于此。
\end{note}

\begin{example}[生日问题]
    $n$个人的生日全不相同的概率$p_n$是多少？
\end{example}
\begin{solution}
    把$n$个人看成是$n$个球，将一年365天看成是$N=365$个盒子，则“$n$个人的生日全不相同”就相当于“恰好有$n (n \le N)$个盒子各有一球”，所以$n$个人的生日全不相同的概率为：
    \[ P_n = \frac{365!}{365^n (365 - n)!} = \biggl(1 - \frac1{365}\biggr) \biggl(1 - \frac{2}{365}\biggr) \dotsb \biggl(1 - \frac{n - 1}{365}\biggr) \]
    上式可用以下方法作近似计算：
    \begin{enumerate}
        \item 当$n$较小时，原式右边中各因子的第二项之间的乘积$\frac{i}{365} \times \frac{j}{365}$都可以忽略，于是有近似公式
              \[ p_n \approx 1 - \frac{1 + 2 + \dotsb + (n - 1)}{365}  = 1 - \frac{n (n - 1)}{730}\]
        \item 当 $n$ 较大时，因为对小的正数$x$有$\ln (1-x) \approx -x$，所以由原式得
              \[ \ln p_n \approx \frac{1 + 2 + \dotsb + (n - 1)}{365} = -\frac{n (n - 1)}{730}\]
    \end{enumerate}
\end{solution}

\subsection{几何概型}

几何概型的基本思想:
\begin{description}
    \item[不可数样本点] 如果一个随机现象的样本空间$\Omega$充满某个区域，其测度(长度、面积或体积等)大小可用$S_\Omega$表示;
    \item[测度等可能性] 任意一点落在测度相同的子区域内是等可能的。
\end{description}

\begin{definition}[几何概型]
    若将“在区域$\Omega$中随机地取一点，而该点落在区域$g$中”记为事件$A_g$，则其概率定义为
    \[ \P(A_g) = \frac{S_g}{S_\Omega}\]
\end{definition}

\begin{example}[会商问题]
    甲乙两人约定在下午6时到7时之间在某处会面，并约定先到者应等候另一个人\SI{20}{\minute}，过时即可离去。求两人能会面的概率。
\end{example}
\begin{solution}
    以$x$和$y$分别表示甲、乙两人到达约会地点的时间 (以 \si{\minute} 为单位)，在平面上建立 $xOy$ 直角坐标系 (见图\ref{fig:meeting_problem}).
    \begin{figure}[!ht]
        \centering
        \begin{tikzpicture}[thick,>=stealth]
            \draw[->] (-0.5,0) -- (0,0) node[below left]{$O$} -- (1,0) node[below]{20} -- (3,0)node[below]{60} -- (3.5,0)node[below]{$x$};
            \draw [->] (0,-0.5) -- (0,1) node[left]{20} -- (0,3) node[left]{60} -- (0,3.5) node[right] {$y$};
            \filldraw[pattern=vertical lines]
            (0,0) -- (1,0) -- (3,2) -- (3,3) -- (2,3) -- (0,1) -- cycle;
            \draw (3,0) -- (3,2) (0,3) -- (2,3);
        \end{tikzpicture}
        \caption{会面问题中的 $\Omega$ 与 $A$.}
        \label{fig:meeting_problem}
    \end{figure}
    因为甲、乙都是在 0 至 \SI{60}{\minute} 内等可能地到达，所以由等可能性知这是一个几何概率问题。$(x, y)$ 的所有可能取值是边长为 60 的正方形，其面积为 $S_\Omega = 60^2$。而事件 $A =$“两人能够会面”相当于:
    \[ \abs(x - y) \le 20 \]
    即图中的阴影部分，其面积为 $S_A = 60^2 - 40^2$，由 \eqref{eq1.2.13} 式知
    \[ P (A) = \frac{S_A}{S_\Omega} = \frac{60^2 - 40^2}{60^2} = 0.5556 \]
\end{solution}

\begin{example}[蒲丰投针问题]
    平面上画有间隔为 $d (d > 0)$ 的等距平行线,
    向平面任意投掷一枚长为 $l (l<d)$ 的针,
    求针与任一平行线相交的概率.
\end{example}
\begin{solution}
    以 $x$ 表示针的中点与最近一条平行线的距离,
    又以 $\varphi$ 表示针与此直线间的交角,
    见图~\ref{fig1.2.4}.
    易知样本空间 $\Omega$ 满足
    \[
        0 \le x \le d/2, \quad 0 \le \varphi \le \pi,
    \]
    由这两式可以确定 $x - \varphi$ 平面上的一个矩形 $\Omega$,
    这就是样本空间,
    其面积为 $S_\Omega = d\pi/2$.
    这时为了针与平行线相交 (记为事件 $A$),
    其充要条件是
    \[
        x \le \frac{l}{2} \sin \varphi.
    \]
    由这个不等式表示的区域是图~\ref{fig1.2.5} 中的阴影部分.

    由于针是向平面任意投掷的,
    所以由等可能性知这是一个几何概率问题.
    由此得
    \[
        P (A) = \frac{S_A}{S_\Omega}
        = \frac{\int_0^\pi \frac{l}{2} \sin \varphi \, \mathrm{d} \varphi}{\frac{d}{2} \pi}
        = \frac{2l}{d\pi}.
    \]

    如果 $l$, $d$ 为已知,
    则以 $\pi$ 的值代入上式即可计算得 $P(A)$ 之值.
    反之,
    如果已知 $P(A)$ 的值,
    则也可以利用上式去求 $\pi$,
    而关于 $P(A)$ 的值,
    可用从试验中获得的频率去近似它:
    即投针 $N$ 次,
    其中针与平行线相交 $n$ 次,
    则频率 $n/N$ 可作为 $P(A)$ 的估计值,
    于是由
    \[
        \frac{n}{N} \approx P (A) = \frac{2l}{d\pi},
    \]
    可得
    \[
        \pi \approx \frac{2lN}{dn}.
    \]
\end{solution}

\begin{figure}
    \centering
    \begin{minipage}[b]{0.5\linewidth}
        \centering
        \begin{tikzpicture}[thick,>=stealth,scale=1.2]
            \draw (-0.3,1) -- (4,1) (-0.3,-1)--(4,-1)
            node[below]{\phantom{$O$}};
            \draw[<->] (0,1) -- (0,-1)node[midway,fill=white]{$d$};
            \draw (2,1) -- +(45:0.3) --+ (-135:1.7);
            \draw (1.8,1) arc (180:225:0.2);
            \draw (1.51,1) --node[left]{$x$} ++(0,-0.49);
            \node at (1.7,0.85){$\varphi$};
        \end{tikzpicture}
        \caption{蒲丰投针问题}.
        \label{fig1.2.4}
    \end{minipage}
    \begin{minipage}[b]{0.5\linewidth}
        \centering
        \begin{tikzpicture}[thick,>=stealth]
            \draw[->](-0.3,0) -- (0,0)node[below]{$O$}
            -- (pi,0)node[below]{$\pi$} -- (4.2,0) node[below]{$\varphi$};
            \draw[->](0,0) -- (0,2.2)node[left]{$d/2$}
            -- (0,3) node[right]{$x$};
            \draw (0,2.2)--(pi,2.2)node[above right]{$\Omega$} -- (pi,0);
            \filldraw[pattern=north east lines]
            (0,0)-- plot[domain=0:pi,samples=100](\x,{1.3*sin(\x r)}) -- (pi,0)--cycle;
            \node at (1.57,1.6){$\frac l2\sin\varphi$};
        \end{tikzpicture}
        \caption{蒲丰投针问题中的 $\Omega$ 和 $A$}.
        \label{fig1.2.5}
    \end{minipage}
\end{figure}

\begin{example}
    在长度为 $a$ 的线段内任取两点将其分为三段，求它们可以构成一个三角形的概率。
\end{example}

\begin{solution}
    由于是将线段任意分成三段,
    所以由等可能性知这是一个几何概率问题.
    分别用 $x$, $y$ 和 $a - x - y$ 表示线段被分成的三段长度,
    见图~\ref{fig1.2.6}.
    则显然应该有
    \[
        0 < x < a; \quad 0 < y < a; \quad 0 < a - (x + y) < a.
    \]
    第三个式子等价于:
    $0 < x + y < a$.
    所以样本空间为 (见图~\ref{fig1.2.7})
    \[
        \Omega = \{(x, y): 0 < x < a, 0 < y < a, 0 < x + y < a\}.
    \]
    $\Omega$ 的面积为
    \[
        S _\Omega = \frac{a^2}{2}.
    \]

    又根据构成三角形的条件:
    三角形中任意两边之和大于第三边,
    得事件 $A$ 所含样本点 $(x,y)$ 必须满足:
    \begin{align*}
         & 0 < a - (x + y) < x + y, \\
         & 0 < x < y + (a - x - y), \\
         & 0 < y < x + (a - x - y).
    \end{align*}
    整理得
    \[ \frac{a}{2} < x + y < a;\quad 0 < x < \frac{a}{2}; \quad 0 < y < \frac{a}{2} \]
    所以事件 $A$ 可用图~\ref{fig1.2.8} 中的阴影部分表示。事件 $A$ 的面积为
    \[ S _A = \frac{a^2}{8}. \]
    由此得
    \[P (A) = \frac1{4}. \]
\end{solution}

\begin{figure}
    \begin{minipage}[b]{0.3\linewidth}
        \centering
        \begin{tikzpicture}[thick,>=stealth,xscale=1.2]
            \draw (0,0) -- (4,0);
            \draw [densely dashed,yshift=-0.5cm](0,0) -- (4,0) node[midway,fill=white]{$a$};
            \foreach \x in {0,1,2.4,4}
            \draw(\x,-0.1) -- (\x,0.1);
            \draw[yshift=-0.5cm](0,-0.1)--(0,0.1)
            (4,-0.1)--(4,0.1);
            \draw (0.5,0.2)node{$x$} (1.7,0.2)node{$y$}
            (3.2,0.2)node{$a-x-y$};
        \end{tikzpicture}
        \caption{长度为 $a$ 的线段分成三段.}
        \label{fig1.2.6}
    \end{minipage}
    \begin{minipage}[b]{0.3\linewidth}
        \centering
        \begin{tikzpicture}[thick,>=stealth,scale=2.6]
            \draw[->] (-0.2,0) --(1,0)node[below]{$a$}-- (1.5,0)node[below]{$x$};
            \draw[->] (0,-0.2) --(0,0)node[below left]{$O$}
            --(0,1)node[left]{$a$} -- (0,1.2)node[left]{$y$};
            \filldraw[pattern=horizontal lines] (0,0)--(1,0)
            --(0,1)--cycle;
        \end{tikzpicture}
        \caption{线段分成三段的样本空间}
        \label{fig1.2.7}
    \end{minipage}
    \begin{minipage}[b]{0.3\linewidth}
        \centering
        \begin{tikzpicture}[thick,>=stealth,scale=2.6]
            \draw[->] (-0.2,0) --(1,0)node[below]{$a$}-- (1.5,0)node[below]{$x$};
            \draw[->] (0,-0.2) --(0,0)node[below left]{$O$}
            --(0,1)node[left]{$a$}--(0,1.2)node[left]{$y$};
            \draw (0,1) -- (1,0);
            \filldraw[pattern=horizontal lines]
            (0.5,0)node[below]{$1/2$} -- (0.5,0.5)
            --(0,0.5)node[left]{$1/2$} -- cycle;
        \end{tikzpicture}
        \caption{构成三角形的条件}
        \label{fig1.2.8}
    \end{minipage}
\end{figure}

\subsection{Bertrand奇论}

在一圆内任取一条弦，问其长度超过该圆内接等边三角形的边长的概率是多少？这是一个几何概率问题，它有三种解法，具体如下：
\begin{enumerate}
    \item 由于对称性，可只考察某指定方向的弦。作一条直径垂直于这个方向。显然，只有交直径于1/4与3/4之间的弦才能超过正三角形的边长（见图），如此，所求概率为 1/2。
    \item 由于对称性，可让弦的一端点固定，让另一端点在圆周上作随机移动。若在固定端点作一切线，则与此切线夹角在60°与120°之间的弦才能超过正三角形的边长（见图），如此，所求概率为1/3。
    \item 圆内弦的位置被其中点唯一确定。在圆内作一同心圆，其半径仅为大圆半径的一半，则大圆内弦的中点落在小圆内，此弦长才能超过正三角形的边长（见图），如此，所求概率为1/4。
\end{enumerate}

同一问题有三种不同答案，究其原因在圆内“取弦”时规定尚不够具体，不同的“等可能性假定”导致了不同的样本空间。具体如下：其中
“均匀分布”应理解为“等可能取点”。
\begin{enumerate}
    \item 解法一中假定弦的中点在直径上均匀分布，直径上的点组成样本空间
    \item 解法二中假定弦的另 一 活动端点在圆周上均匀分布，圆周上的点组成样本空间
    \item 解法三中假定弦的中点在大圆内均匀分布，大圆内的点组成样本空间
\end{enumerate}

可见，上述三个答案是针对三个不同样本空间引起的，它们都是正确的，贝特朗奇论引起人们注意，在定义概率时要事先明确指出样本空间是什么．

\section{条件概率}

\begin{definition}[条件概率]
    令$A,B \in \mathscr{F}$, 且$P(B)>0$称
    \[ P(A|B) = \frac{P(A \cap B)}{P(B)}\]
    为\textbf{基于于$B$的条件概率}(probability conditional on $B$), 这仍然是一个概率测度.
\end{definition}

\begin{theorem}[乘法法则]
    令$A,B \in \mathscr{F}$, 且$P(B)>0$, 则
    \[ P(A \cap B) = P(A|B)P(B) \]
    泛化后有:
    \[ P(A_1 \cap A_2 \cap \cdots \cap A_n) = P(A_{1})P(A_2|A_1)P(A_3|A_1\cap A_2) \cdots  \]
\end{theorem}

\begin{example}[罐子模型]\label{exam1.4.4}
    设罐中有 $b$ 个黑球、$r$ 个红球,
    每次随机取出一个球,
    取出后将原球放回,
    还加进 $c$ 个同色球和 $d$ 个异色球.
    记 $B_i$ 为“第 $i$ 次取出的是黑球”,
    $R_j$ 为“第 $j$ 次取出的是红球”.

    若连续从罐中取出三个球,
    其中有两个红球、一个黑球.
    则由乘法公式我们可得
    \begin{align*}
        P(B_1 R_2 R_3)
         & = P(B_1) P(R_2 | B_1) P(R_3 | B_1 R_2)                       \\
         & = \frac{b}{b+r} \frac{r+d}{b+r+c+d} \frac{r+d+c}{b+r+2c+2d}, \\
        P(R_1 B_2 R_3)
         & = P(R_1) P(B_2 | R_1) P(R_3 | R_1 B_2)                       \\
         & = \frac{r}{b+r} \frac{b+d}{b+r+c+d} \frac{r+d+c}{b+r+2c+2d}, \\
        P(R_1 R_2 B_3)
         & = P(R_1) P(R_2 | R_1) P(B_3 | R_1 R_2)                       \\
         & = \frac{r}{b+r} \frac{r+c}{b+r+c+d} \frac{b+2d}{b+r+2c+2d}.
    \end{align*}
    以上概率与黑球在第几次被抽取有关.
\end{example}

罐子模型也称为波利亚 (Polya) 模型,
这个模型可以有各种变化,
具体见下:

\begin{enumerate}
    \item 当 $c=-1$, $d=0$ 时,
          即为\textbf{不返回抽样}.
          此时前次抽取结果会影响后次抽取结果.
          但只要抽取的黑球与红球个数确定,
          则概率不依赖其抽出球的次序,
          都是一样的.
          此例中有
          \begin{align*}
              P(B_1 R_2 R_3) & = P(R_1 B_2 R_3) = P(R_1 R_2 B_3)        \\
                             & = \frac{br(r-1)}{(b+r) (b+r-1) (b+r-2)}.
          \end{align*}
          例~\ref{exam1.4.3} 可以归结为此种情况.

    \item 当 $c=0$, $d=0$ 时,
          即为\textbf{返回抽样}.
          此时前次抽取结果不会影响后次抽取结果.
          故上述三个概率相等,
          且都等于
          \[
              P(B_1 R_2 R_3) = P(R_1 B_2 R_3) = P(R_1 R_2 B_3) = \frac{br^2}{(b+r)^3}.
          \]

    \item 当 $c>0, d=0$ 时,
          称为\textbf{传染病模型}.
          此时,
          每次取出球后会增加下一次取到同色球的概率,
          或换句话说,
          每次发现一个传染病患者,
          以后都会增加再传染的概率.
          与前面两个一样,
          以上三个概率都相等,
          且都等于
          \begin{align*}
              P(B_1 R_2 R_3) & = P(R_1 B_2 R_3) = P(R_1 R_2 B_3)       \\
                             & = \frac{br(r+c)}{(b+r)(b+r+c)(b+r+2c)}.
          \end{align*}
          从以上可以看出:
          在罐子模型中只要 $d=0$,
          则以上三个概率都相等.
          即只要抽取的黑球与红球个数确定,
          则概率不依赖其抽出球的次序,
          都是一样的.
          但当 $d>0$ 时,
          就不同了.

    \item 当 $c=0, d>0$ 时,
          称为\textbf{安全模型}.
          此模型可解释为:
          每当事故发生了 (红球被取出),
          安全工作就抓紧一些,
          下次再发生事故的概率就会减少;
          而当事故没有发生时 (黑球被取出),
          安全工作就放松一些,
          下次再发生事故的概率就会增大.
          在这种场合,
          上述三个概率分别为
          \begin{align*}
               & P(B_1 R_2 R_3) = \frac{b}{b+r} \frac{r+d}{b+r+d} \frac{r+d}{b+r+2d}, \\
               & P(R_1 B_2 R_3) = \frac{r}{b+r} \frac{b+d}{b+r+d} \frac{r+d}{b+r+2d}, \\
               & P(R_1 R_2 B_3) = \frac{r}{b+r} \frac{r}{b+r+d} \frac{b+2d}{b+r+2d}.
          \end{align*}
\end{enumerate}

\begin{theorem}[全概率公式]
    设 $B_1, B_2, \dotsc, B_n$ 为样本空间 $\Omega$ 的一个分割, 且互不相容, 即$\bigcup _{i=1} ^n B_i = \Omega, B_i B_j= \emptyset for i \neq j $
    如果 $P(B_i) > 0$, $i=1, 2, \dotsc, n$,
    则对任一事件 $A$ 有
    \begin{equation}
        P(A) = \sum_{i=1}^n P(B_i) P(A | B_i).
    \end{equation}
\end{theorem}

\begin{note}
    $P(A | B_i)$可视为事件$A$在$B_i$上的平均, $P(B_i)$则为其权重.
\end{note}

\begin{theorem}[Bayes定理]
    设 $B_1, B_2, \dotsc, B_n$ 为样本空间 $\Omega$ 的一个分割, 且互不相容, 即$\bigcup _{i=1} ^n B_i = \Omega, B_i B_j= \emptyset for i \neq j $
    如果 $P(A) > 0$, $P(B_i) > 0$, $i = 1,2, \dotsc, n$,
    则
    \begin{equation}
        P (B_i | A) = \frac{P(B_i) P(A|B_i)}{\sum_{j=1}^n P(B_j) P(A|B_j)}
    \end{equation}
\end{theorem}

\begin{example}
    某地区居民的肝癌发病率为 \num{0.0004},
    现用甲胎蛋白法进行普查.
    医学研究表明,
    化验结果是存有错误的.
    已知患有肝癌的人其化验结果 \SI{99}{\percent} 呈阳性 (有病),
    而没患肝癌的人其化验结果 \SI{99.9}{\percent} 呈阴性 (无病).
    现某人的检查结果呈阳性,
    问他真的患肝癌的概率是多少?
\end{example}

\begin{solution}
    记 $B$ 为事件“被检查者患有肝癌”,
    $A$ 为事件“检查结果呈阳性”.
    由题设知
    \begin{gather*}
        P(B) = 0.0004, \quad P(\overline{B}) = 0.996,\\
        P(A|B) = 0.99, \quad P(A|\overline{B}) = 0.001.
    \end{gather*}

    我们现在的目的是求 $P(B|A)$.
    由贝叶斯公式得
    \begin{align*}
        P(B|A) & = \frac{P(B) P(A|B)}{P(B) P(A|B) + P(\overline{B}) P(A|\overline{B})} \\
               & = \frac{0.0004 \times 0.99}{0.0004 \times 0.99 + 0.9996 \times 0.001} \\
               & = 0.284.
    \end{align*}
    这表明,
    在检查结果呈阳性的人中,
    真患肝癌的人不到 \SI{30}{\percent},
    这个结果可能会使人吃惊,
    但仔细分析一下就可以理解了.
    因为肝癌发病率很低,
    在 \num{10000} 个人中,
    约有 4 人,
    而约有 \num{9996} 个人不惠肝癌.
    对 \num{10000} 个人用甲胎蛋白法进行检查,
    按其错检的概率可知,
    \num{9996} 个不患肝癌者中约有 $9996 \times 0.001 \cong 9.994$ 个呈阳性.
    另外 4 个真患肝癌者的检查报告中约有 $4 \times 0.99 \cong 3.96 $ 个呈阳性.
    仅从 \num{13.956} 个呈阳性者中看,
    真患肝癌的 3.96 人约占 \SI{28.4}{\percent}.
\end{solution}

\begin{example}
    伊索寓言“孩子与狼”讲的是一个小孩每天到山上放羊，山里有狼出没.第一天，他在山上喊：“狼来了！狼来了！”，山下的村民闻声便去打狼，可到山上，发现狼没有来；第二天仍是如此；第三天，狼真的来了，可无论小孩怎么喊叫，也没有人来救他，因为前二次他说了谎，人们不再相信他了.
\end{example}

现在用贝叶斯公式来分析此寓言中村民对这个小孩的可信程度是如何下降的.

首先记事件$A$为“小孩说谎”，记事件$B$为“小孩可信”.不妨设村民过去对这个小孩的印象为
\begin{equation}\label{eq1.4.7}
    P(B) = 0.8,\quad P(\bar B) = 0.2.
\end{equation}

我们现在用贝叶斯公式来求$P(B|A)$，亦即这个小孩说了一次谎后，村民对他可信程度的改变.

在贝叶斯公式中我们要用到概率$P(A|B)$和$P(A|\bar B)$，这两个概率的含义是：前者为“可信”$(B)$的孩子“说谎”$(A)$的可能性，后者为“不可信”$(\bar B)$的孩子“说谎”$(A)$的可能性.在此不妨设
\[
    P(A|B) = 0.1,\quad P(A|\bar B) = 0.5.
\]

第一次村民上山打狼，发现狼没有来，即小孩说了谎$(A)$.村民根据这个信息，对这个小孩的可信程度改变为（用贝叶斯公式）
\begin{align*}
    P(B|A) & = \frac{P(B)P(A|B)}{P(B)P(A|B) + P(\bar B)P(A|\bar B) }     \\
           & = \frac{0.8\times0.1}{0.8\times0.1 + 0.2\times0.5} = 0.444.
\end{align*}

这表明村民上了一次当后，对这个小孩的可信程度由原来的0.8调整为
0.444，也就是 \eqref{eq1.4.7} 调整为
\begin{equation}\label{eq1.4.8}
    P(B) = 0.444,\quad P(\bar B) = 0.556.
\end{equation}
在此基础上，我们再一次用贝叶斯公式来计算$P(B|A)$，亦即这个小孩第二次说谎后，村民对他的可信程度改变为
\[
    P(B|A) = \frac{0.444\times0.1}{0.444\times0.1 + 0.556\times0.5} = 0.138.
\]

这表明村民们经过两次上当，对这个小孩的可信程度已经从0.8下降到了
0.138，如此低的可信度，村民听到第三次呼叫时怎么再会上山打狼呢?

\section{独立性}

\begin{definition}[事件的独立性]
    如果$A,B\in\mathscr{F}$满足
    \[ P(A\cap B) = P(A)P(B), \]
    则称$A$与$B$\textbf{独立}(independent), 记为$A \Vbar B$.

    对于事件集$A_1, A_2, \dotsc, A_n$, 若对于其中任意子集$A_{i_1}, A_{i_2}, \dotsc, A_{i_n}$有:
    \[ P(A_{i_1} \cap \cdots  \cap A_{i_n}) =P(A_{i_1})\cdots P(A_{i_n})  \]
    则称此事件集\textbf{相互独立}(mutually independent)
\end{definition}

\begin{note}
    当$P(A)>0$时, 我们有$ P(B|A) = P(B) \iff B \Vbar A$, 由此可得到\underline{$B$独立于$A$}的直观理解
\end{note}

\begin{property}
    独立性是对称的, 即$A \Vbar B \iff B \Vbar A$. 若两事件独立, 则其补集也独立.
    \begin{center}
        \begin{tikzpicture}
            \node[draw=none,fill=none] (1) at(0,0) {$A^{\complement}$};
            \node[draw=none,fill=none] (2) at(1,0) {$B^{\complement}$};
            \node[draw=none,fill=none] (3) at(0,1) {$A$};
            \node[draw=none,fill=none] (4) at(1,1) {$B$};
            \draw[<->] (1)--(2);
            \draw[<->] (1)--(4);
            \draw[<->] (3)--(2);
            \draw[<->] (3)--(4);
        \end{tikzpicture}
    \end{center}
\end{property}

\begin{definition}[事件域的独立性]
    若$\mathscr{G} \subset \mathscr{F}$与$\mathscr{H} \subset \mathscr{F}$满足
    \[ A \Vbar B, \quad \forall A\in\mathscr{G},\ B\in\mathscr{H}, \]
    则称$\mathscr{G}$与$\mathscr{H}$独立, 记为$\mathscr{G} \Vbar \mathscr{H}$
\end{definition}

测度论告诉我们一个重要结果: 如果$\mathscr{G}$对交集运算封闭, 那么成立$\mathscr{G}\Vbar\mathscr{H} \implies \sigma(\mathscr{G}) \Vbar \mathscr{H}$

\begin{example}
    有两名选手比赛射击，轮流对同一目标进行射击，甲命中目标的概率为$\alpha$，乙命中目标的概率为$\beta$.甲先射，谁先命中谁得胜.问甲、乙两人获胜的概率各为多少?
\end{example}
\begin{solution}
    记事件$A_i$为“第i次射击命中目标”，$i=1,2$，因为甲先射，所以事件“甲获胜”可以表示为
    \[
        A_1 \cup \bar A_1\bar A_2 A_3 \cup \bar A_1\bar A_2
        \bar A_3\bar A_4A_5\cup\cdots,
    \]
    又因为各次射击是独立的，所以得
    \begin{align*}
        P(\,\text{甲获胜}\,) & = \alpha + (1-\alpha)(1-\beta)\alpha + (1-\alpha)^2(1-\beta)^2\alpha + \cdots \\
                             & = \alpha\sum_{i=0}^{+\infty}(1-\alpha)^i(1-\beta)^i                           \\
                             & = \frac{\alpha}{1-(1-\alpha)(1-\beta)}.
    \end{align*}
    同理可得
    \begin{align*}
        P(\,\text{乙获胜}\,) & = P (\bar A_1A_2\cup \bar A_1\bar A_2\bar A_3A_4\cup\cdot)      \\
                             & = (1-\alpha)\beta + (1-\alpha)(1-\beta)(1-\alpha)\beta + \cdots \\
                             & \beta (1-\alpha)\sum_{i=0}^{+\infty}(1-\alpha)^i(1-\beta)^i     \\
                             & = \frac{\beta(1-\alpha)}{1-(1-\alpha)(1-\beta)}.
    \end{align*}
\end{solution}

此题在等比级数求和时，应该有条件：公比$|(1-\alpha)(1-\beta)|M1$. 这一点不难从题目的实际意义中得到. 因为对本题而言，$\alpha,\beta$取值为零或1均是无意义的.

\begin{example}
    系统由多个元件组成，且所有元件都独立地工作.设每个元件正常工作的概率都为$p=0.9$，试求以下系统正常工作的概率.
    \begin{enumerate}[label=(\arabic*)]
        \item 串联系统$S_1$：\begin{tikzpicture}[baseline=(a.base),thick]
                  \draw (0,0) -- (4,0);
                  \node(a)[minimum width=1cm,minimum height=0.4cm,draw,fill=white] at (1,0){1};
                  \node[minimum width=1cm,minimum height=0.4cm,draw,fill=white] at (3,0){2};
              \end{tikzpicture}.
        \item 并联系统$S_2$：\begin{tikzpicture}[baseline=(a.base),thick,
                      every node/.style =
                          { minimum width=1cm,minimum height=0.4cm,draw,fill=white}]
                  \node[draw = white](a) at (2,0) {};
                  \draw (0,0) -- (1,0)  (3,0) -- (4,0)
                  (1.5,-0.4) -- (1,-0.4) -- (1,0.4) -- (1.5,0.4)
                  (2.5,-0.4) -- (3,-0.4) -- (3,0.4) -- (2.5,0.4);
                  \node at (2,-0.4) {1} ;
                  \node at (2,0.4) {2} ;
              \end{tikzpicture}.
        \item 5个元件组成的桥式系统$S_3$：\begin{tikzpicture}[baseline=(a.base),thick,
                      every node/.style =
                          { minimum width=1cm,minimum height=0.4cm,draw,fill=white}]
                  \node[draw = white] (a) at (0,0) {};
                  \draw (0,0) -- (1,0) (3,-0.6) -- (3,0.6) (5,0) -- (6,0)
                  (1,0.6) -- (1,-0.6) -- (5,-0.6) -- (5,0.6) -- cycle;
                  \node at (2,-0.6) {4};
                  \node at (2,0.6) {1};
                  \node at (3,0) {3};
                  \node at (4,0.6) {2};
                  \node at (4,-0.6) {5};
              \end{tikzpicture}.
    \end{enumerate}
\end{example}

\begin{solution}
    设$S_i=$“第$i$个系统正常工作”，$A_i=$“第$i$个元件正常工作”.

    \begin{itemize}[(1)]
        \item 对申联系统而言，“系统正常工作”相当于“所有元件正常工作”，即$S_1=A_1A_2$，所以
              \[
                  P(S_1) = P(A_1A_2) = P(A_1)P(A_2) = p^2 = 0.81.
              \]
              这也可看出：两个正常工作概率为0.9的元件组成的串联系统，其系统正常工作的概率下降为0.81.
        \item 对并联系统而言，“系统正常工作”相当于“至少一个元件正常工作”，即$S_2=A_1\cup A_2$，所以
              \begin{align*}
                  P(S_2) & P(A_1\cup A_2) = P(A_1) + P(A_2) - P(A_1A_2) \\
                         & = p + p - p^2 = 0.99.
              \end{align*}
              或
              \begin{align*}
                  P(S_2) & = 1 - P(\bar S_2) = 1 - P(\bar{A_1\cup A_2}) = 1 - P(\bar A_1\cap \bar A_2) \\
                         & = 1 - P(\bar A_1)P(\bar A_2) = 1 - (1-p)^2 = 0.99.
              \end{align*}
              这也可看出：两个正常工作概率为0.9的元件组成的并联系统，其系统正常工作的概率提高至0.99.
        \item 在桥式系统中，第3个元件是关键，我们先用全概率公式得
              \[
                  P(S_3) = P(A_3)P(S_3|A_3) + P(\bar A_3)P(S_3|\bar A_3).
              \]
              因为在“第3个元件正常工作”的条件下，系统成为先并后串系统（见图 \ref{fig1.5.1}）. 所以
              \begin{align*}
                  P(S_3|A_3) & = P\big( ( A_1\cup A_4 )
                  (A_2 \cup A_5) \big) = P(A_1\cup A_4)P(A_2\cup A_5) \\
                             & = [ 1 - (1-p)^2 ]^2 = 0.9801.
              \end{align*}
              又因为在“第3个元件不正常工作”的条件下，系统成为先串后并系统（见图 \ref{fig1.5.2}）.
    \end{itemize}
    \begin{figure}[!ht]
        \centering
        \begin{minipage}{0.48\linewidth}
            \centering
            \begin{tikzpicture}[baseline=(a.base),thick,
                    every node/.style =
                        { minimum width=1cm,minimum height=0.4cm,draw,fill=white}]
                \node[draw = white] (a) at (0,0) {};
                \draw (0,0) -- (1,0) (2.9,0) -- (3.1,0)
                (5,0) -- (6,0) (2.9,-0.6) -- (2.9,0.6)
                (3.1,-0.6) -- (3.1,0.6)
                (1,0.6) -- (1,-0.6)(2.9,-0.6) (3.1,-0.6)-- (5,-0.6) -- (5,0.6) -- (3.1,0.6) (2.9,0.6) -- cycle;
                \draw (1,0.6) -- (2.9,0.6) (1,-0.6) -- (2.9,-0.6);
                \node at (2,-0.6) {4};
                \node at (2,0.6) {1};
                \node at (4,0.6) {2};
                \node at (4,-0.6) {5};
            \end{tikzpicture}
            \caption{先并后串系统\label{fig1.5.1}}
        \end{minipage}%
        \begin{minipage}{0.48\linewidth}
            \centering
            \begin{tikzpicture}[baseline=(a.base),thick,
                    every node/.style =
                        { minimum width=1cm,minimum height=0.4cm,draw,fill=white}]
                \node[draw = white] (a) at (0,0) {};
                \draw (0,0) -- (1,0)  (5,0) -- (6,0)
                (1,0.6) -- (1,-0.6) -- (5,-0.6) -- (5,0.6) -- cycle;
                \node at (2,-0.6) {4};
                \node at (2,0.6) {1};
                \node at (4,0.6) {2};
                \node at (4,-0.6) {5};
            \end{tikzpicture}
            \caption{先串后并系统\label{fig1.5.2}}
        \end{minipage}
    \end{figure}
    所以
    \[
        P(S_3|\bar A_3) = P(A_1A_2|\cup A_4A_5) = 1 - (1-p^2)^2 = 0.9639.
    \]
    最后我们得
    \begin{align*}
        P(S_3) & = p [ 1-(1-p)^2 ]^2 + (1-p)[ 1-(1-p^2)^2 ]       \\
               & = 0.9\times 0.9801 + 0.1 \times 0.9639 = 0.9785.
    \end{align*}
\end{solution}

\begin{problemset}[错题记录]
    \item （茆1.2.4）从一副52张的扑克牌中任取4张，求下列事件的概率:
    \begin{enumerate}
        \item 全是黑桃;
        \item 同花;
        \item 没有两张同一花色;
        \item 同色.
    \end{enumerate}
    \item （茆1.2.5）考虑一元二次方程$x^2+Bx+C=O$，其中$B,C$分别是将一颗骰子接连掷两次先后出现的点数，求该方程有实根的概率和有重根的概率
    \item （茆1.2.10）从$n$个数$1, 2, \cdots, n$中任取2个，问其中一个小于$k (1 < k < n)$，另一个大于$k$的概率是多少？
    \item （茆1.2.13）把10本书任意地放在书架上，求其中指定的三本书放在一起的概率.
    \item （茆1.2.19）$n$个男孩，$m$个女孩($m \le n + 1$)随机地排成一排，试求任意两个女孩都不相邻的概率.
    \item （茆1.2.20）将3个球随机地放入4个杯子中去，求杯子中球的最大个数分别为1, 2, 3的概率各为多少？
    \item （茆1.2.22）将 $n$ 个完全相同的球 (这时也称球是不可辨的) 随机地放入 $N$ 个盒子中，试求恰好有 $m$ 个空盒的概率
    \item （茆1.2.23）在区间 $(0,1)$ 中随机地取两个数，求事件“两数之和小于7/5”的概率.
    \item
\end{problemset}
